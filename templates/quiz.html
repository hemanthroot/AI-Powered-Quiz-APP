<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Quiz</title>

    <style>
        body {
            font-family: "Segoe UI", Arial, sans-serif;
            background: linear-gradient(120deg, #667eea, #764ba2);
            margin: 0;
            padding: 0;
        }

        .container {
            width: 70%;
            margin: 40px auto;
            background: #ffffff;
            padding: 30px 40px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        h2 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }

        .question-box {
            background: #f9f9ff;
            border-left: 6px solid #667eea;
            padding: 15px 20px;
            margin-bottom: 25px;
            border-radius: 8px;
        }

        .question {
            font-size: 17px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
        }

        .option {
            display: block;
            background: #ffffff;
            border: 1px solid #ddd;
            padding: 10px 15px;
            margin-bottom: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }

        .option:hover {
            background: #eef1ff;
            border-color: #667eea;
        }

        input[type="radio"] {
            margin-right: 10px;
        }

        .submit-btn {
            display: block;
            width: 100%;
            padding: 14px;
            font-size: 16px;
            font-weight: bold;
            background: linear-gradient(90deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.3s;
        }

        .submit-btn:hover {
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .container {
                width: 90%;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <h2>ðŸ§  AI Generated Quiz</h2>
    <h3 id="timer">Time Left: 05:00</h3>

    <form action="/submit" method="post">

        {% for q in quiz %}
        <div class="question-box">
            <div class="question">
                {{ loop.index }}. {{ q.question }}
            </div>
            {% set qname = "q" ~ loop.index0 %}
            {% for opt in q.options %}
            <label class="option">
                <input type="radio" name="{{ qname }}" value="{{ opt }}" required>
                {{ opt }}
            </label>
            {% endfor %}
            <input type="hidden" name="ans_{{ qname }}" value="{{ q.answer }}">
        </div>
        <input type="hidden"
           name="ans_{{ qname }}"
           value="{{ q.answer }}">

    <!-- âœ… Hidden AI explanation -->
    <input type="hidden"
           name="exp_{{ qname }}"
           value="{{ q.explanation }}">

    <hr>
        {% endfor %}
        <button class="submit-btn" type="submit">Submit Quiz</button>

    </form>
</div>
<script>
history.pushState(null, null, location.href);
window.onpopstate = function () {
    history.go(1);
};

window.onbeforeunload = function () {
    return "Exam in progress. Leaving will cancel the test.";
};
let time = 300; // 5 minutes
const timer = setInterval(() => {
    let min = Math.floor(time / 60);
    let sec = time % 60;
    document.getElementById("timer").innerText =
        `Time Left: ${min}:${sec < 10 ? '0'+sec : sec}`;

    if (time <= 0) {
        clearInterval(timer);
        alert("Time up! Submitting exam.");
        document.forms[0].submit();
    }
    time--;
}, 1000);
</script>

</body>
</html>
